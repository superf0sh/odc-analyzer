@import com.ysoft.odc.statistics.FailedProjects
@(
    projectsWithSelection: ProjectsWithSelection,
    name: String,
    failedProjects: FailedProjects,
    issueOption: Option[(ExportedVulnerability[String], String)]
)(implicit header: DefaultRequest, mainTemplateData: MainTemplateData)

@main(
    title = s"Unknown vulnerability $name for ${projectsWithSelection.projectNameText}",
    projectsOption = Some((projectsWithSelection, p => routes.Statistics.vulnerability(name, p)))
){
    @healthReport(failedProjects)
    <div class="alert alert-warning">Vulnerability <i>@name</i> is not found@if(projectsWithSelection.isProjectSpecified){ for selected project(s)}.</div>
    <h2>Possible solutions</h2>
    <ul class="solutions">
        @if(projectsWithSelection.isProjectSpecified){
            <li>
                Maybe the vulnerability does not affect this project, but it might affect other projects.<br>
                <a class="btn btn-success" href="@routes.Statistics.vulnerability(name, None)">Look at all the projects!</a>
            </li>
        }
        @for((ticket, issueLink) <- issueOption){
            <li>See the <a href="@issueLink">related ticket @ticket.ticket</a>.</li>
        }
        <li>
            Maybe the vulnerability does not affect any of the projects.<br>
            <a href="https://web.nvd.nist.gov/view/vuln/detail?vulnId=@helper.urlEncode(name)" class="btn btn-default">Look at NVD</a>
        </li>
    </ul>
}